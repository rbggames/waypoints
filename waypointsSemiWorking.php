<?php 


$waypoints  = array( array("ref" => 1,
"child" => "2:5",
"latlong" =>"52.480551:-1.942031",
"xy" => "404034:286960"),
array( "ref" => 2,
"child" => "1:3",
"latlong" =>"52.48239:-1.934828",
"xy" => "404522:287165"),
array( "ref" => 3,
"child" => "2:4",
"latlong" =>"52.478227:-1.934775",
"xy" => "404526:286701"),
array( "ref" => 4,
"child" => "3:5",
"latlong" =>"52.476583:-1.936824",
"xy" => "404388:286518"),
array( "ref" => 5,
"child" => "4:1",
"latlong" =>"52.476093:-1.944952",
"xy" => "403836:286464"),
array( "ref" => 6,
"child" => "7",
"latlong" =>"52.510051:-2.009092",
"xy" => "399480:290240"),
array( "ref" => 7,
"child" => "6:8",
"latlong" =>"52.505035:-1.991441",
"xy" => "400678:289682"),
array( "ref" => 8,
"child" => "7:9:153",
"latlong" =>"52.50168:-1.978802",
"xy" => "401536:289309"),
array( "ref" => 9,
"child" => "8:10",
"latlong" =>"52.497516:-1.972235",
"xy" => "401982:288846"),
array( "ref" => 10,
"child" => "9:11",
"latlong" =>"52.499446:-1.961598",
"xy" => "402704:289061"),
array( "ref" => 11,
"child" => "10:12:47",
"latlong" =>"52.498113:-1.95391",
"xy" => "403226:288913"),
array( "ref" => 12,
"child" => "11:13",
"latlong" =>"52.491204:-1.942253",
"xy" => "404018:288145"),
array( "ref" => 13,
"child" => "12:14",
"latlong" =>"52.491579:-1.938276",
"xy" => "404288:288187"),
array( "ref" => 14,
"child" => "13:15",
"latlong" =>"52.491668:-1.935403",
"xy" => "404483:288197"),
array( "ref" => 15,
"child" => "14:16",
"latlong" =>"52.492223:-1.932575",
"xy" => "404675:288259"),
array( "ref" => 16,
"child" => "15:17",
"latlong" =>"52.490062:-1.926658",
"xy" => "405077:288109"),
array( "ref" => 17,
"child" => "16:18",
"latlong" =>"52.486826:-1.927444",
"xy" => "405024:287659"),
array( "ref" => 18,
"child" => "17:19",
"latlong" =>"52.484373:-1.928773",
"xy" => "404934:287386"),
array( "ref" => 19,
"child" => "18:20",
"latlong" =>"52.481448:-1.924139",
"xy" => "405249:287061"),
array( "ref" => 20,
"child" => "19:21:49",
"latlong" =>"52.479018:-1.919182",
"xy" => "405586:286791"),
array( "ref" => 21,
"child" => "20:22",
"latlong" =>"52.478765:-1.917268",
"xy" => "405716:286763"),
array( "ref" => 22,
"child" => "21:23",
"latlong" =>"52.480155:-1.913069",
"xy" => "406001:286918"),
array( "ref" => 23,
"child" => "22:24",
"latlong" =>"52.481949:-1.908074",
"xy" => "406340:287118"),
array( "ref" => 24,
"child" => "23:25",
"latlong" =>"52.485469:-1.901852",
"xy" => "406762:287510"),
array( "ref" => 25,
"child" => "24:26",
"latlong" =>"52.487371:-1.8974",
"xy" => "407064:287722"),
array( "ref" => 26,
"child" => "25:27:60",
"latlong" =>"52.490258:-1.888925",
"xy" => "407639:288044"),
array( "ref" => 27,
"child" => "26:28",
"latlong" =>"52.48924:-1.887013",
"xy" => "407769:287931"),
array( "ref" => 28,
"child" => "27:29",
"latlong" =>"52.486945:-1.884663",
"xy" => "407929:287676"),
array( "ref" => 29,
"child" => "28:30",
"latlong" =>"52.484264:-1.881769",
"xy" => "408126:287378"),
array( "ref" => 30,
"child" => "29:31",
"latlong" =>"52.483005:-1.881478",
"xy" => "408146:287238"),
array( "ref" => 31,
"child" => "30:32",
"latlong" =>"52.480193:-1.883959",
"xy" => "407978:286925"),
array( "ref" => 32,
"child" => "31:33",
"latlong" =>"52.477888:-1.879754",
"xy" => "408264:286669"),
array( "ref" => 33,
"child" => "32:34:125",
"latlong" =>"52.475862:-1.876521",
"xy" => "408484:286444"),
array( "ref" => 34,
"child" => "33:35",
"latlong" =>"52.472823:-1.876235",
"xy" => "408504:286106"),
array( "ref" => 35,
"child" => "34:36",
"latlong" =>"52.466855:-1.869628",
"xy" => "408954:285443"),
array( "ref" => 36,
"child" => "35:37",
"latlong" =>"52.46343:-1.861955",
"xy" => "409476:285063"),
array( "ref" => 37,
"child" => "36:38",
"latlong" =>"52.461873:-1.85987",
"xy" => "409618:284890"),
array( "ref" => 38,
"child" => "37:39:210:211",
"latlong" =>"52.459357:-1.84675",
"xy" => "410510:284612"),
array( "ref" => 39,
"child" => "38:40",
"latlong" =>"52.460334:-1.837327",
"xy" => "411150:284722"),
array( "ref" => 40,
"child" => "39:41",
"latlong" =>"52.455965:-1.818948",
"xy" => "412400:284239"),
array( "ref" => 41,
"child" => "40:42",
"latlong" =>"52.453484:-1.813734",
"xy" => "412755:283964"),
array( "ref" => 42,
"child" => "41:43",
"latlong" =>"52.449617:-1.812544",
"xy" => "412837:283534"),
array( "ref" => 43,
"child" => "42:44",
"latlong" =>"52.445629:-1.809295",
"xy" => "413059:283091"),
array( "ref" => 44,
"child" => "43:45",
"latlong" =>"52.440857:-1.804579",
"xy" => "413381:282561"),
array( "ref" => 45,
"child" => "44:46",
"latlong" =>"52.437132:-1.797387",
"xy" => "413871:282148"),
array( "ref" => 46,
"child" => "45:192",
"latlong" =>"52.432356:-1.78123",
"xy" => "414971:281620"),
array( "ref" => 47,
"child" => "11:48",
"latlong" =>"52.488747:-1.937838",
"xy" => "404318:287872"),
array( "ref" => 48,
"child" => "47:49:51",
"latlong" =>"52.485661:-1.933174",
"xy" => "404635:287529"),
array( "ref" => 49,
"child" => "20:50",
"latlong" =>"52.478771:-1.913867",
"xy" => "405947:286764"),
array( "ref" => 50,
"child" => "49:164",
"latlong" =>"52.475998:-1.907836",
"xy" => "406357:286456"),
array( "ref" => 51,
"child" => "48:52",
"latlong" =>"52.485096:-1.935325",
"xy" => "404489:287466"),
array( "ref" => 52,
"child" => "51:53",
"latlong" =>"52.484665:-1.936327",
"xy" => "404416:287428"),
array( "ref" => 53,
"latlong" => "52:54",
"latlong" =>"52.481657:-1.943325",
"xy" => "403946:287083"),
array( "ref" => 54,
"child" => "53:55",
"latlong" =>"52.480013:-1.946567",
"xy" => "403726:286900"),
array( "ref" => 55,
"child" => "54:56",
"latlong" =>"52.476779:-1.950369",
"xy" => "403468:286540"),
array( "ref" => 56,
"child" => "55:57",
"latlong" =>"52.474262:-1.95233",
"xy" => "403335:286260"),
array( "ref" => 57,
"child" => "56:58",
"latlong" =>"52.472599:-1.953333",
"xy" => "403267:286075"),
array( "ref" => 58,
"child" => "57:59",
"latlong" =>"52.469723:-1.953851",
"xy" => "403232:285755"),
array( "ref" => 59,
"child" => "58",
"latlong" =>"52.463473:-1.948456",
"xy" => "403599:285060"),
array( "ref" => 60,
"child" => "26:61",
"latlong" =>"52.49111:-1.886906",
"xy" => "407776:288139"),
array( "ref" => 61,
"child" => "60:62",
"latlong" =>"52.492636:-1.884884",
"xy" => "407913:288309"),
array( "ref" => 62,
"child" => "61:63",
"latlong" =>"52.495213:-1.881637",
"xy" => "408133:288596"),
array( "ref" => 63,
"child" => "62:64",
"latlong" =>"52.496668:-1.879718",
"xy" => "408263:288758"),
array( "ref" => 64,
"child" => "63:65",
"latlong" =>"52.500751:-1.873122",
"xy" => "408710:289213"),
array( "ref" => 65,
"child" => "64:66",
"latlong" =>"52.503625:-1.87083",
"xy" => "408865:289533"),
array( "ref" => 66,
"child" => "65:67",
"latlong" =>"52.506872:-1.863675",
"xy" => "409350:289895"),
array( "ref" => 67,
"child" => "66:68:112:113",
"latlong" =>"52.507035:-1.850238",
"xy" => "410262:289915"),
array( "ref" => 68,
"child" => "67:69",
"latlong" =>"52.50989:-1.833461",
"xy" => "411400:290235"),
array( "ref" => 69,
"child" => "68:70",
"latlong" =>"52.512371:-1.82741",
"xy" => "411810:290512"),
array( "ref" => 70,
"child" => "69:71",
"latlong" =>"52.51521:-1.820105",
"xy" => "412305:290829"),
array( "ref" => 71,
"child" => "70:72",
"latlong" =>"52.516414:-1.813587",
"xy" => "412747:290964"),
array( "ref" => 72,
"child" => "71:73",
"latlong" =>"52.518311:-1.808023",
"xy" => "413124:291176"),
array( "ref" => 73,
"child" => "72:74:95:96",
"latlong" =>"52.519918:-1.801355",
"xy" => "413576:291356"),
array( "ref" => 74,
"child" => "73:75",
"latlong" =>"52.524505:-1.79224",
"xy" => "414193:291868"),
array( "ref" => 75,
"child" => "74:76:92:93",
"latlong" =>"52.527504:-1.785195",
"xy" => "414670:292203"),
array( "ref" => 76,
"child" => "75:77",
"latlong" =>"52.528838:-1.777273",
"xy" => "415207:292353"),
array( "ref" => 77,
"child" => "76:78",
"latlong" =>"52.529423:-1.768352",
"xy" => "415812:292420"),
array( "ref" => 78,
"child" => "77:79",
"latlong" =>"52.53202:-1.754304",
"xy" => "416764:292712"),
array( "ref" => 79,
"child" => "78:80",
"latlong" =>"52.535182:-1.740546",
"xy" => "417696:293067"),
array( "ref" => 80,
"child" => "79:81",
"latlong" =>"52.546808:-1.807309",
"xy" => "413164:294346"),
array( "ref" => 81,
"child" => "80:82",
"latlong" =>"52.551621:-1.809869",
"xy" => "412989:294881"),
array( "ref" => 82,
"child" => "81:83",
"latlong" =>"52.556481:-1.813122",
"xy" => "412767:295421"),
array( "ref" => 83,
"child" => "82:84",
"latlong" =>"52.559823:-1.811795",
"xy" => "412856:295793"),
array( "ref" => 84,
"child" => "83:85",
"latlong" =>"52.560813:-1.81216",
"xy" => "412831:295903"),
array( "ref" => 85,
"child" => "84:86",
"latlong" =>"52.564403:-1.808973",
"xy" => "413046:296303"),
array( "ref" => 86,
"child" => "85",
"latlong" =>"52.566473:-1.810365",
"xy" => "412951:296533"),
array( "ref" => 87,
"child" => "88",
"latlong" =>"52.53158:-1.825271",
"xy" => "411950:292649"),
array( "ref" => 88,
"child" => "87:89",
"latlong" =>"52.530494:-1.820441",
"xy" => "412278:292529"),
array( "ref" => 89,
"child" => "88:90",
"latlong" =>"52.529366:-1.818102",
"xy" => "412437:292404"),
array( "ref" => 90,
"child" => "89:91",
"latlong" =>"52.528888:-1.816629",
"xy" => "412537:292351"),
array( "ref" => 91,
"child" => "90:92",
"latlong" =>"52.528572:-1.815717",
"xy" => "412599:292316"),
array( "ref" => 92,
"child" => "91:75",
"latlong" =>"52.528137:-1.813994",
"xy" => "412716:292268"),
array( "ref" => 93,
"child" => "75:94",
"latlong" =>"52.523306:-1.806218",
"xy" => "413245:291732"),
array( "ref" => 94,
"child" => "93:95",
"latlong" =>"52.521414:-1.803352",
"xy" => "413440:291522"),
array( "ref" => 95,
"child" => "94:73",
"latlong" =>"52.520269:-1.801397",
"xy" => "413573:291395"),
array( "ref" => 96,
"child" => "73:97",
"latlong" =>"52.519159:-1.799206",
"xy" => "413722:291272"),
array( "ref" => 97,
"child" => "96:98",
"latlong" =>"52.525122:-1.780166",
"xy" => "415012:291939"),
array( "ref" => 98,
"child" => "97:99",
"latlong" =>"52.519993:-1.777538",
"xy" => "415192:291369"),
array( "ref" => 99,
"child" => "98",
"latlong" =>"52.517639:-1.783224",
"xy" => "414807:291106"),
array( "ref" => 100,
"child" => "101",
"latlong" =>"52.553283:-1.984205",
"xy" => "401168:295049"),
array( "ref" => 101,
"child" => "100:102",
"latlong" =>"52.552176:-1.978454",
"xy" => "401558:294926"),
array( "ref" => 102,
"child" => "101:103",
"latlong" =>"52.55116:-1.977053",
"xy" => "401653:294813"),
array( "ref" => 103,
"child" => "102:104",
"latlong" =>"52.546978:-1.968473",
"xy" => "402235:294348"),
array( "ref" => 104,
"child" => "103:105:144",
"latlong" =>"52.544748:-1.965791",
"xy" => "402417:294100"),
array( "ref" => 105,
"child" => "104:106",
"latlong" =>"52.543348:-1.947876",
"xy" => "403632:293945"),
array( "ref" => 106,
"child" => "105:107",
"latlong" =>"52.538462:-1.939404",
"xy" => "404207:293402"),
array( "ref" => 107,
"child" => "106:108",
"latlong" =>"52.532515:-1.916091",
"xy" => "405789:292742"),
array( "ref" => 108,
"child" => "107:109",
"latlong" =>"52.532422:-1.912259",
"xy" => "406049:292732"),
array( "ref" => 109,
"child" => "108:110",
"latlong" =>"52.529906:-1.891892",
"xy" => "407431:292454"),
array( "ref" => 110,
"child" => "109:111",
"latlong" =>"52.525377:-1.883944",
"xy" => "407971:291951"),
array( "ref" => 111,
"child" => "110:112",
"latlong" =>"52.520067:-1.878726",
"xy" => "408326:291361"),
array( "ref" => 112,
"child" => "111:67:143",
"latlong" =>"52.514505:-1.872302",
"xy" => "408763:290743"),
array( "ref" => 113,
"child" => "67:114",
"latlong" =>"52.505428:-1.858671",
"xy" => "409690:289735"),
array( "ref" => 114,
"child" => "113:115",
"latlong" =>"52.503899:-1.858528",
"xy" => "409700:289565"),
array( "ref" => 115,
"child" => "114:116",
"latlong" =>"52.501805:-1.858947",
"xy" => "409672:289332"),
array( "ref" => 116,
"child" => "115:117",
"latlong" =>"52.498993:-1.860503",
"xy" => "409567:289019"),
array( "ref" => 117,
"child" => "116:118",
"latlong" =>"52.494161:-1.864834",
"xy" => "409274:288481"),
array( "ref" => 118,
"child" => "117:119",
"latlong" =>"52.490743:-1.862783",
"xy" => "409414:288101"),
array( "ref" => 119,
"child" => "118:120",
"latlong" =>"52.487795:-1.863086",
"xy" => "409394:287773"),
array( "ref" => 120,
"child" => "119:121",
"latlong" =>"52.482897:-1.865163",
"xy" => "409254:287228"),
array( "ref" => 121,
"child" => "120:122",
"latlong" =>"52.481281:-1.867126",
"xy" => "409121:287048"),
array( "ref" => 122,
"child" => "121:123",
"latlong" =>"52.479801:-1.869604",
"xy" => "408953:286883"),
array( "ref" => 123,
"child" => "122:124",
"latlong" =>"52.479217:-1.870548",
"xy" => "408889:286818"),
array( "ref" => 124,
"child" => "123:125",
"latlong" =>"52.478365:-1.872377",
"xy" => "408765:286723"),
array( "ref" => 125,
"child" => "124:33",
"latlong" =>"52.477845:-1.873232",
"xy" => "408707:286665"),
array( "ref" => 126,
"child" => "127",
"latlong" =>"52.565074:-1.829992",
"xy" => "411621:296374"),
array( "ref" => 127,
"child" => "126:128",
"latlong" =>"52.561862:-1.848149",
"xy" => "410391:296014"),
array( "ref" => 128,
"child" => "127:129",
"latlong" =>"52.559738:-1.860886",
"xy" => "409528:295776"),
array( "ref" => 129,
"child" => "128:130",
"latlong" =>"52.556826:-1.868905",
"xy" => "408985:295451"),
array( "ref" => 130,
"child" => "129:131",
"latlong" =>"52.555974:-1.871459",
"xy" => "408812:295356"),
array( "ref" => 131,
"child" => "130:132",
"latlong" =>"52.552666:-1.871365",
"xy" => "408819:294988"),
array( "ref" => 132,
"child" => "131:133",
"latlong" =>"52.550573:-1.872625",
"xy" => "408734:294755"),
array( "ref" => 133,
"child" => "132:134",
"latlong" =>"52.549197:-1.872894",
"xy" => "408716:294602"),
array( "ref" => 134,
"child" => "133:135",
"latlong" =>"52.547037:-1.869877",
"xy" => "408921:294362"),
array( "ref" => 135,
"child" => "134:136",
"latlong" =>"52.543481:-1.865656",
"xy" => "409208:293967"),
array( "ref" => 136,
"child" => "135:137",
"latlong" =>"52.539135:-1.862322",
"xy" => "409435:293484"),
array( "ref" => 137,
"child" => "136:138",
"latlong" =>"52.537651:-1.861339",
"xy" => "409502:293319"),
array( "ref" => 138,
"child" => "137:139",
"latlong" =>"52.532393:-1.862609",
"xy" => "409417:292734"),
array( "ref" => 139,
"child" => "138:140",
"latlong" =>"52.530352:-1.870398",
"xy" => "408889:292506"),
array( "ref" => 140,
"child" => "139:141",
"latlong" =>"52.528845:-1.873837",
"xy" => "408656:292338"),
array( "ref" => 141,
"child" => "140:142",
"latlong" =>"52.524321:-1.871345",
"xy" => "408826:291835"),
array( "ref" => 142,
"child" => "141:143",
"latlong" =>"52.52227:-1.87054",
"xy" => "408881:291607"),
array( "ref" => 143,
"child" => "142:112",
"latlong" =>"52.516464:-1.863823",
"xy" => "409338:290962"),
array( "ref" => 144,
"child" => "104:145",
"latlong" =>"52.541375:-1.960456",
"xy" => "402779:293725"),
array( "ref" => 145,
"child" => "144:146",
"latlong" =>"52.537121:-1.955889",
"xy" => "403089:293252"),
array( "ref" => 146,
"child" => "145:147",
"latlong" =>"52.530559:-1.958549",
"xy" => "402909:292522"),
array( "ref" => 147,
"child" => "146:148",
"latlong" =>"52.527504:-1.961765",
"xy" => "402691:292182"),
array( "ref" => 148,
"child" => "147:149",
"latlong" =>"52.519569:-1.973267",
"xy" => "401911:291299"),
array( "ref" => 149,
"child" => "148:150",
"latlong" =>"52.517546:-1.974049",
"xy" => "401858:291074"),
array( "ref" => 150,
"child" => "149:151",
"latlong" =>"52.513053:-1.979799",
"xy" => "401468:290574"),
array( "ref" => 151,
"child" => "150:152",
"latlong" =>"52.511884:-1.978296",
"xy" => "401570:290444"),
array( "ref" => 152,
"child" => "151:153:159:160",
"latlong" =>"52.507928:-1.97793",
"xy" => "401595:290004"),
array( "ref" => 153,
"child" => "152:8",
"latlong" =>"52.507478:-1.975249",
"xy" => "401777:289954"),
array( "ref" => 154,
"child" => "155",
"latlong" =>"52.520174:-2.004142",
"xy" => "399816:291366"),
array( "ref" => 155,
"child" => "154:156",
"latlong" =>"52.518781:-2.000281",
"xy" => "400078:291211"),
array( "ref" => 156,
"child" => "155:157",
"latlong" =>"52.517477:-1.996567",
"xy" => "400330:291066"),
array( "ref" => 157,
"child" => "156:158",
"latlong" =>"52.514106:-1.991557",
"xy" => "400670:290691"),
array( "ref" => 158,
"child" => "157:159",
"latlong" =>"52.512173:-1.988581",
"xy" => "400872:290476"),
array( "ref" => 159,
"child" => "158:152",
"latlong" =>"52.508936:-1.982954",
"xy" => "401254:290116"),
array( "ref" => 160,
"child" => "152:161",
"latlong" =>"52.506866:-1.971212",
"xy" => "402051:289886"),
array( "ref" => 161,
"child" => "160:162",
"latlong" =>"52.5061:-1.9661",
"xy" => "402398:289801"),
array( "ref" => 162,
"child" => "161:163",
"latlong" =>"52.50565:-1.964406",
"xy" => "402513:289751"),
array( "ref" => 163,
"child" => "162",
"latlong" =>"52.505173:-1.962904",
"xy" => "402615:289698"),
array( "ref" => 164,
"child" => "50:165",
"latlong" =>"52.47456:-1.908575",
"xy" => "406307:286296"),
array( "ref" => 165,
"child" => "164:166",
"latlong" =>"52.473079:-1.911199",
"xy" => "406129:286131"),
array( "ref" => 166,
"child" => "165:167",
"latlong" =>"52.461915:-1.926307",
"xy" => "405104:284888"),
array( "ref" => 167,
"child" => "166:168",
"latlong" =>"52.457529:-1.928272",
"xy" => "404971:284400"),
array( "ref" => 168,
"child" => "167:169",
"latlong" =>"52.45106:-1.936301",
"xy" => "404426:283680"),
array( "ref" => 169,
"child" => "168:170",
"latlong" =>"52.442701:-1.937755",
"xy" => "404328:282750"),
array( "ref" => 170,
"child" => "169:171",
"latlong" =>"52.427384:-1.926423",
"xy" => "405100:281047"),
array( "ref" => 171,
"child" => "170:172",
"latlong" =>"52.420881:-1.921405",
"xy" => "405442:280324"),
array( "ref" => 172,
"child" => "171:173:242",
"latlong" =>"52.42016:-1.918877",
"xy" => "405614:280244"),
array( "ref" => 173,
"child" => "172:174:243",
"latlong" =>"52.416358:-1.920104",
"xy" => "405531:279821"),
array( "ref" => 174,
"child" => "173:175",
"latlong" =>"52.408331:-1.922324",
"xy" => "405381:278928"),
array( "ref" => 175,
"child" => "174",
"latlong" =>"52.401836:-1.928876",
"xy" => "404936:278205"),
array( "ref" => 176,
"child" => "177",
"latlong" =>"52.506746:-1.756802",
"xy" => "416604:289900"),
array( "ref" => 177,
"child" => "176:178",
"latlong" =>"52.501518:-1.750467",
"xy" => "417036:289320"),
array( "ref" => 178,
"child" => "177:179",
"latlong" =>"52.491258:-1.736799",
"xy" => "417968:288182"),
array( "ref" => 179,
"child" => "178:180",
"latlong" =>"52.488963:-1.735561",
"xy" => "418053:287927"),
array( "ref" => 180,
"child" => "179:181",
"latlong" =>"52.486358:-1.736651",
"xy" => "417980:287637"),
array( "ref" => 181,
"child" => "180:182",
"latlong" =>"52.483758:-1.739833",
"xy" => "417765:287347"),
array( "ref" => 182,
"child" => "181:183",
"latlong" =>"52.48183:-1.741905",
"xy" => "417625:287132"),
array( "ref" => 183,
"child" => "182:184",
"latlong" =>"52.480349:-1.742871",
"xy" => "417560:286967"),
array( "ref" => 184,
"child" => "183:185",
"latlong" =>"52.479111:-1.744027",
"xy" => "417482:286829"),
array( "ref" => 185,
"child" => "184:186",
"latlong" =>"52.47415:-1.749179",
"xy" => "417134:286276"),
array( "ref" => 186,
"child" => "185:187",
"latlong" =>"52.471711:-1.756524",
"xy" => "416636:286003"),
array( "ref" => 187,
"child" => "186:188",
"latlong" =>"52.468544:-1.759383",
"xy" => "416443:285650"),
array( "ref" => 188,
"child" => "187:189",
"latlong" =>"52.464011:-1.767547",
"xy" => "415890:285144"),
array( "ref" => 189,
"child" => "188:190",
"latlong" =>"52.452192:-1.769007",
"xy" => "415795:283829"),
array( "ref" => 190,
"child" => "189:191",
"latlong" =>"52.449702:-1.768976",
"xy" => "415798:283552"),
array( "ref" => 191,
"child" => "190:192",
"latlong" =>"52.442146:-1.771384",
"xy" => "415637:282711"),
array( "ref" => 192,
"child" => "191:46",
"latlong" =>"52.444675:-1.777741",
"xy" => "415204:282991"),
array( "ref" => 193,
"child" => "194",
"latlong" =>"52.488598:-1.758537",
"xy" => "416493:287881"),
array( "ref" => 194,
"child" => "193:195",
"latlong" =>"52.487233:-1.763375",
"xy" => "416165:287728"),
array( "ref" => 195,
"child" => "194:196",
"latlong" =>"52.490136:-1.777026",
"xy" => "415237:288048"),
array( "ref" => 196,
"child" => "195:197",
"latlong" =>"52.492706:-1.781358",
"xy" => "414942:288333"),
array( "ref" => 197,
"child" => "196:198",
"latlong" =>"52.494057:-1.782795",
"xy" => "414844:288483"),
array( "ref" => 198,
"child" => "197:199",
"latlong" =>"52.495203:-1.784851",
"xy" => "414704:288610"),
array( "ref" => 199,
"child" => "198:200",
"latlong" =>"52.495927:-1.787794",
"xy" => "414504:288690"),
array( "ref" => 200,
"child" => "199:201",
"latlong" =>"52.494647:-1.790525",
"xy" => "414319:288547"),
array( "ref" => 201,
"child" => "200:202",
"latlong" =>"52.495511:-1.79653",
"xy" => "413911:288642"),
array( "ref" => 202,
"child" => "201:203",
"latlong" =>"52.489878:-1.81526",
"xy" => "412641:288012"),
array( "ref" => 203,
"child" => "202:204",
"latlong" =>"52.479296:-1.820502",
"xy" => "412288:286834"),
array( "ref" => 204,
"child" => "203:205",
"latlong" =>"52.475569:-1.82299",
"xy" => "412120:286419"),
array( "ref" => 205,
"child" => "204:206",
"latlong" =>"52.472569:-1.824681",
"xy" => "412006:286085"),
array( "ref" => 206,
"child" => "205:207",
"latlong" =>"52.469885:-1.827473",
"xy" => "411817:285786"),
array( "ref" => 207,
"child" => "206:208",
"latlong" =>"52.467346:-1.831207",
"xy" => "411564:285503"),
array( "ref" => 208,
"child" => "207:209",
"latlong" =>"52.465859:-1.834716",
"xy" => "411326:285337"),
array( "ref" => 209,
"child" => "208:210",
"latlong" =>"52.464443:-1.838254",
"xy" => "411086:285179"),
array( "ref" => 210,
"child" => "209:38:211",
"latlong" =>"52.462201:-1.842442",
"xy" => "410802:284929"),
array( "ref" => 211,
"child" => "38:212",
"latlong" =>"52.45575:-1.850309",
"xy" => "410269:284211"),
array( "ref" => 212,
"child" => "211:213",
"latlong" =>"52.452543:-1.854072",
"xy" => "410014:283853"),
array( "ref" => 213,
"child" => "212:214",
"latlong" =>"52.45151:-1.854929",
"xy" => "409956:283738"),
array( "ref" => 214,
"child" => "213:215",
"latlong" =>"52.448049:-1.854911",
"xy" => "409958:283353"),
array( "ref" => 215,
"child" => "214:216",
"latlong" =>"52.442853:-1.854781",
"xy" => "409968:282775"),
array( "ref" => 216,
"child" => "215:217",
"latlong" =>"52.436875:-1.854948",
"xy" => "409958:282110"),
array( "ref" => 217,
"child" => "216:218",
"latlong" =>"52.434465:-1.855029",
"xy" => "409953:281842"),
array( "ref" => 218,
"child" => "217:219",
"latlong" =>"52.431858:-1.855229",
"xy" => "409940:281552"),
array( "ref" => 219,
"child" => "218:220",
"latlong" =>"52.429119:-1.857076",
"xy" => "409815:281247"),
array( "ref" => 220,
"child" => "219:221",
"latlong" =>"52.420868:-1.859058",
"xy" => "409682:280329"),
array( "ref" => 221,
"child" => "220:222",
"latlong" =>"52.417845:-1.87308",
"xy" => "408729:279991"),
array( "ref" => 222,
"child" => "221",
"latlong" =>"52.417463:-1.877125",
"xy" => "408454:279948"),
array( "ref" => 223,
"child" => "224",
"latlong" =>"52.453086:-1.91221",
"xy" => "406063:283907"),
array( "ref" => 224,
"child" => "223:225",
"latlong" =>"52.455619:-1.909556",
"xy" => "406243:284189"),
array( "ref" => 225,
"child" => "224:226",
"latlong" =>"52.458467:-1.906975",
"xy" => "406418:284506"),
array( "ref" => 226,
"child" => "225:227",
"latlong" =>"52.462375:-1.903802",
"xy" => "406633:284941"),
array( "ref" => 227,
"child" => "226:228",
"latlong" =>"52.465313:-1.901293",
"xy" => "406803:285268"),
array( "ref" => 228,
"child" => "227:229",
"latlong" =>"52.465326:-1.89648",
"xy" => "407130:285270"),
array( "ref" => 229,
"child" => "228:230",
"latlong" =>"52.46651:-1.893239",
"xy" => "407350:285402"),
array( "ref" => 230,
"child" => "229:231",
"latlong" =>"52.46446:-1.892773",
"xy" => "407382:285174"),
array( "ref" => 231,
"child" => "230:232",
"latlong" =>"52.463221:-1.894248",
"xy" => "407282:285036"),
array( "ref" => 232,
"child" => "231:233",
"latlong" =>"52.460228:-1.894814",
"xy" => "407244:284703"),
array( "ref" => 233,
"child" => "232:234",
"latlong" =>"52.45463:-1.898771",
"xy" => "406976:284080"),
array( "ref" => 234,
"child" => "233:235",
"latlong" =>"52.450007:-1.906507",
"xy" => "406451:283565"),
array( "ref" => 235,
"child" => "234:236",
"latlong" =>"52.44601:-1.911488",
"xy" => "406113:283120"),
array( "ref" => 236,
"child" => "235:237",
"latlong" =>"52.445066:-1.911858",
"xy" => "406088:283015"),
array( "ref" => 237,
"child" => "236:238",
"latlong" =>"52.439852:-1.911692",
"xy" => "406100:282435"),
array( "ref" => 238,
"child" => "237:239",
"latlong" =>"52.437246:-1.912506",
"xy" => "406045:282145"),
array( "ref" => 239,
"child" => "238:240",
"latlong" =>"52.431468:-1.916636",
"xy" => "405765:281502"),
array( "ref" => 240,
"child" => "239:241",
"latlong" =>"52.427846:-1.917937",
"xy" => "405677:281099"),
array( "ref" => 241,
"child" => "240:242",
"latlong" =>"52.426677:-1.917909",
"xy" => "405679:280969"),
array( "ref" => 242,
"child" => "241:172",
"latlong" =>"52.423486:-1.917959",
"xy" => "405676:280614"),
array( "ref" => 243,
"child" => "173:244",
"latlong" =>"52.410502:-1.928686",
"xy" => "404948:279169"),
array( "ref" => 244,
"child" => "243:245",
"latlong" =>"52.410927:-1.93214",
"xy" => "404713:279216"),
array( "ref" => 245,
"child" => "244:246",
"latlong" =>"52.410748:-1.934272",
"xy" => "404568:279196"),
array( "ref" => 246,
"child" => "245:247",
"latlong" =>"52.409914:-1.938904",
"xy" => "404253:279103"),
array( "ref" => 247,
"child" => "246:248",
"latlong" =>"52.41007:-1.944607",
"xy" => "403865:279120"),
array( "ref" => 248,
"child" => "247:249",
"latlong" =>"52.410971:-1.94909",
"xy" => "403560:279220"),
array( "ref" => 249,
"child" => "248:250",
"latlong" =>"52.409417:-1.951076",
"xy" => "403425:279047"),
array( "ref" => 250,
"child" => "249:251",
"latlong" =>"52.407934:-1.953695",
"xy" => "403247:278882"),
array( "ref" => 251,
"child" => "240:252",
"latlong" =>"52.408116:-1.959545",
"xy" => "402849:278902"),
array( "ref" => 252,
"child" => "251:253",
"latlong" =>"52.40836:-1.96197",
"xy" => "402684:278929"),
array( "ref" => 253,
"child" => "252:254",
"latlong" =>"52.406968:-1.968851",
"xy" => "402216:278774"),
array( "ref" => 254,
"child" => "253:255",
"latlong" =>"52.403976:-1.973968",
"xy" => "401868:278441"),
array( "ref" => 255,
"child" => "254",
"latlong" =>"52.401882:-1.976468",
"xy" => "401698:278208")
);

             
             
             
$start = $waypoints[50];
$end = $waypoints[59];
$done = "FALSE";



$closedList = array();
$openList = array();
$children = array();
$checkNode = $start;

array_push($openList,$start);
array_push($closedList, $start);


function findClosestChild($children,$end){
    $closestNode = "";
    $closestNodeDist = 9999999999999999999999999999999999999999999999999999999999999999999999999999;
    for ($i=0; $i<count($children); $i++)
    {
        global $openList;
        global $closedList;
        $curCheckNodeDist = findDistance($children[$i],$end);
        if($curCheckNodeDist < $closestNodeDist and in_array($children[$i],$closedList,true) == false){
            $closestNodeDist = $curCheckNodeDist;
            $closestNode = $children[$i];
        }
        array_push($closedList, $children[$i]);
    }
    //array_push($oList, $closestNode);
    array_push($openList,$closestNode );
    global $checkNode;
    $checkNode = $closestNode;
    
}

function findDistance($child,$end){
    $childxy  = explode(":", $child["xy"]);
    $endxy = explode(":",$end["xy"]);
    
    
    $distance = sqrt(pow(($childxy[0]-$endxy[0]),2) + pow(($childxy[1]-$endxy[1]),2));
    return $distance;
} 
             
             
             
echo "<html>";
echo "<head>";
echo "</head>";
echo "<body>"; 



while($done == "FALSE"){
    if(end($openList) == $end){
        $done = "TRUE";
    }else{
        empty($children);
        //var_dump($checkNode["ref"]);
        //var_dump($checkNode["child"]);
        //var_dump($checkNode);
        if(strpos($checkNode["child"],":")!== FALSE){
            $childrenNum = explode(":",$checkNode["child"]);
        }
        else{
            $childrenNum = $checkNode["child"];
        }
        
        for ($i=0; $i<count($childrenNum); $i++)
        {
            $a = (int)$childrenNum[$i];
            array_push($children ,$waypoints[$a-1]); 
        }
        findClosestChild($children,$end);
    }
    
} 

for ($i=1; $i<count($openList); $i++){
    echo $i . "  ";
    echo $openList[$i]["ref"] . "</br>";
        
}

echo "<h1>Point details</h1>";
echo $waypoints[2]["title"]." is point number ".$waypoints[3]["ref"]." and its child is number ".$waypoints[3]["child"]."<br />";
echo "</body>";
echo "</html>";
?>